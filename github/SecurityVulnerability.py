from typing import Any, Dict

from github.FirstPatchedVersion import FirstPatchedVersion
from github.GithubObject import NonCompletableGithubObject, NotSet
from github.Package import Package


class SecurityVulnerability(NonCompletableGithubObject):
    """
    This class represents SecurityVulnerability. The reference can be found here in the alert here https://docs.github.com/en/rest/dependabot/alerts#list-dependabot-alerts-for-a-repository
    """

    def __repr__(self) -> str:
        return self.get__repr__(
            {
                "package": self._package.value,
                "severity": self._severity.value,
                "vulnerable_version_range": self._vulnerable_version_range.value,
                "first_patched_version": self._first_patched_version.value,
            }
        )

    @property
    def first_patched_version(self) -> FirstPatchedVersion:
        return self._first_patched_version.value

    @property
    def package(self) -> Package:
        return self._package.value

    @property
    def severity(self) -> str:
        return self._severity.value

    @property
    def vulnerable_version_range(self) -> str:
        return self._vulnerable_version_range.value

    def _initAttributes(self) -> None:
        self._first_patched_version = NotSet
        self._package = NotSet
        self._severity = NotSet
        self._vulnerable_version_range = NotSet

    def _useAttributes(self, attributes: Dict[str, Any]) -> None:
        if "first_patched_version" in attributes:  # pragma no branch
            self._first_patched_version = self._makeClassAttribute(
                FirstPatchedVersion, attributes["first_patched_version"]
            )
        if "package" in attributes:  # pragma no branch
            self._package = self._makeClassAttribute(Package, attributes["package"])
        if "severity" in attributes:  # pragma no branch
            self._severity = self._makeStringAttribute(attributes["severity"])
        if "vulnerable_version_range" in attributes:  # pragma no branch
            self._vulnerable_version_range = self._makeStringAttribute(attributes["vulnerable_version_range"])
